# 1. 目的・背景

「他人軸」から「自分軸」へ移行するための毎日の気づき（GOOD）と内省（自由記入）を支える。

**続けられる設計**（入力摩擦の最小化、当日モチベーションUP、同日振り返り）を重視。

**可視化は最小限の数値 + テキスト中心**。AI による完全な定量化は難度が高いため、初期は軽量化。

# 2. MVP

- **1日1回の記録**（GOOD/自由記入/任意のメディア）
- **同日振り返り**（過去年の同日を上部に表示）
- **週次/月次のテキストサマリー**（軽量指標：記録数、継続日数、キーワード抽出）
- **プッシュ通知**（継続支援。iOS バッジ対応、サイレントプッシュ検討）

# 3. MVP外

- リッチなグラフ/スコアリングによる高度な可視化
- コミュニティ機能/共有タイムライン
- 決済（将来のサブスクを見据えた設計のフックは保持）

# 4. ユーザーフロー

1. **初回起動（匿名）** → ホーム（日記入力可）
2. **当日入力**：GOOD（1〜3件/任意）、自由記入、画像/動画（任意）
3. **同日振り返り**：画面上部に過去年の同日分カードを表示
4. **サマリー閲覧**：週次/月次タブ（テキスト中心）
5. **後から会員登録**：Apple/Google/メールのいずれか。匿名データを安全に移行
6. **通知**：毎日の入力リマインド、週次/月次サマリー通知

# 5. 画面設計

## 5.1 タブ構成

- ホーム
- 軸
- レポート
- マイページ

## 5.2 ホーム

- 日付スライダー
- 継続日数
- 記録への誘導・記録の表示
- あなたへのメッセージ
- 今日の一言

## 5.3 ジャーナル入力

- あなたの軸
- 入力エリア
    - 感情・気分
    - GOODポイント
    - 行動できた価値観
    - 自分らしさ度
    - 今日の気づき・感じたこと
    - 写真（必須でないかも）
    - 保存ボタン

## 5.4 軸

- 価値観
- 理想の姿
- 定量目標

## 5.5 レポート

- 記入日数
- 自分軸度
- 感情分析
- 達成価値観
- あなたへのメッセージ

## 5.6 設定

- アカウント
- 機能
- 通知
- サービス

## 5.7 会員登録・ログイン

- メースアドレス
- Google
- Apple

## 5.8 スプラッシュ・オンボーディング

- ロゴの表示
- 使い方や効果の説明

# 6. データ設計

## 6.1 データ一覧

- User（ユーザー）
- Entry（1日の記録）
    - GoodItem
    - FreeNote
    - MediaFile
- Device（プッシュ通知などに使用）
- Summary
- UserValue（価値観）
- UserGoalQualitative（定性ゴール）
- UserNumberGoal（定量ゴール）
- NotificationPreference

## 6.2 DB構造

### 6.2.1 User

```sql
enum UserType { ANONYMOUS REGISTERED }

model User {
  id           String   @id @default(cuid())   // 内部ID（UUID相当）
  type         UserType @default(ANONYMOUS)   // ゲスト or 会員
  authProvider String   // 'anonymous' | 'google' | 'apple' | 'email'
  email        String?  @unique
  createdAt    DateTime @default(now())
  lastSeenAt   DateTime @default(now()) @updatedAt
  isActive     Boolean  @default(true)

  // 関連
  entries      Entry[]
  devices      Device[]
}

```

### 6.2.2 Entry

```sql
model Entry {
  id        String   @id @default(cuid())
  userId    String
  date      DateTime

  goodItems GoodItem[]
  freeNote  FreeNote?
  mediaFiles MediaFile[]
  reviewMessage String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user      User     @relation(fields: [userId], references: [id])

  @@unique([userId, date]) // 同一ユーザーで日付重複不可
}

```

### 6.2.3 GoogItem

```sql
model GoodItem {
  id      String @id @default(cuid())
  entryId String
  text    String @db.Text

  entry   Entry  @relation(fields: [entryId], references: [id])
}
```

### 6.2.4 MediaFile

```sql
model MediaFile {
  id          String  @id @default(cuid())
  entryId     String
  mimeType    String
  bytes       Int
  width       Int?
  height      Int?
  durationMs  Int?
  storageKey  String
  thumbnailKey String?
  isVideo     Boolean @default(false)
  createdAt   DateTime @default(now())

  entry       Entry @relation(fields: [entryId], references: [id])
}

```

### 6.2.5 Device

```sql
model Device {
  id         String   @id @default(cuid())
  userId     String
  platform   String   // 'ios' | 'android'
  fcmToken   String   @unique
  apnsToken  String?
  isActive   Boolean  @default(true)
  lastSeenAt DateTime @default(now())

  user       User     @relation(fields: [userId], references: [id])
}

```